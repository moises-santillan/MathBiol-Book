# The Damped Harmonic Oscillator {#ch18}
 

**Abstract**

This chapter introduces the canonical second-order differential equation governing damped harmonic motion as one of the most fundamental and ubiquitous models for describing oscillatory behavior near equilibrium across physics, engineering, and biology. The governing equation is derived from first principles using physical analogs including a spring-mass system, pendulum, and RLC electrical circuit. Analytical solutions to the differential equation are explored and qualitative analysis of its dynamics is performed by reformulating it as a system of first-order equations, characterizing stability properties through eigenvalue analysis and classifying oscillatory regimes. Overall, the chapter establishes the broad relevance of the damped harmonic oscillator framework while providing context for future examination of oscillatory phenomena through dynamical systems theory.

## Introduction
The harmonic oscillator is one of the most ubiquitous models found across physics, engineering, and biology. At its simplest, a harmonic oscillator describes the oscillatory motion of a mass attached to an ideal linear spring. Due to the restoring force exerted by the spring in response to displacement from equilibrium, the motion takes the form of simple harmonic oscillations.

More generally, any physical system that displays oscillatory behavior about an equilibrium point can be approximated as a harmonic oscillator, provided the restoring force is proportional to displacement and acts in the opposite direction. Examples include the vibrations of molecules, pendulums with small amplitude swings, electrical circuits containing inductors and capacitors, and even whole organs or organisms displaying rhythmic dynamics like the beating of the heart or circadian rhythms.

In reality, no oscillator is truly isolated from its environment. Damping forces arising from friction or dissipation act to sap the oscillator's energy over time. This gives rise to the damped harmonic oscillator model, where a force proportional but opposed to velocity is included. The damped harmonic oscillator provides a minimal yet remarkably versatile modeling framework applicable across science and engineering.

In this chapter, we introduce the damped harmonic oscillator differential equation from three physical perspectives: a mass-spring system, a pendulum, and an electrical RLC circuit. Through linearization and stability analysis techniques, we explore the oscillator's steady state behavior and classify different regimes of underdamped, critically damped, and overdamped motion. Finally, we discuss examples of biological oscillators that adhere to damped harmonic dynamics, establishing the broad relevance and fundamental importance of this ubiquitous model.

## Spring-mass system
We begin our examination of the damped harmonic oscillator by considering the classical spring-mass system. As shown in Fig. {ref}`fig:18.01`, this consists of a point mass $m$ attached to an ideal linear spring with stiffness constant $K$. The spring exerts a restoring force $F_s$ proportional to the displacement $x$ of the mass from its equilibrium position, according to Hooke's law: $F_s = -Kx$.

In addition to the conservative restoring force of the spring, the system experiences a dampening force $F_d$ due to friction as the mass oscillates. We model this as a viscous drag force proportional to velocity: $F_d = -b\dot{x}$, where $b$ is the damping coefficient.

By Newton's second law, the equation of motion for this system is given by:
$$
m\ddot{x} = F_s + F_d = -Kx - b\dot{x}
$$

By scaling time by $1/\sqrt{K/m}$, the equation takes the form:
$$
\ddot{x} + 2\zeta\dot{x} + x = 0
$$

where the damping ratio $\zeta=b/\left(2\sqrt{km}\right)$ characterizes the relative contribution of damping forces.

This spring-mass representation provides a straightforward mechanical depiction of the damped harmonic oscillator and will serve as a useful reference point for discussion. The normalized equation governs a wide range of oscillatory systems, as we will explore in subsequent sections.

```{figure} Figures/fig-18.01.png
:name: fig:18.01

Spring-mass system with friction.
```

## Pendulum
We next consider how the damped harmonic oscillator model applies to small oscillations of a physical pendulum. As illustrated in Fig. {ref}`fig:18.02`, this consists of a point mass $m$ hanging from a rigid rod of length $L$, which is fixed at one end to a pivot.

For small angular displacements $\theta$ from the hanging equilibrium position, the gravitational torque on the mass can be approximated as $\tau \approx -mgL\theta$. Additionally, the pivot exerts a viscous damping torque $\tau_f = -b\dot{\theta}$ opposing the angular velocity.

Treating the mass-rod system as a rigid body with moment of inertia $I=mL^2$, Newton's second law for rotational motion gives:
$$
I\alpha = \tau+\tau_f
$$

where $\alpha = \ddot{\theta}$ is the angular acceleration. This yields the equation of motion:
$$
mL^2\ddot{\theta} = -mgL\theta - b\dot{\theta}
$$

Non-dimensionalizing via the rescaling $t\rightarrow t/\sqrt{g/L}$, we obtain the normalized form of the damped harmonic oscillator with damping ratio $\zeta=b/\left(2m\sqrt{g/L}\right)$:
$$
\ddot{\theta} + 2\zeta\dot{\theta} + \theta = 0
$$

    
Thus, despite involving circular rather than linear motion, the mathematical description of small oscillations in a simple pendulum is identical to that of the spring-mass system. Both phenomena are governed by the ubiquitous damping harmonic oscillator equation near their equilibrium points.

```{figure} Figures/fig-18.02.png
:name: fig:18.02

Pendulum displaying small angular displacement $\theta$.
```

## RLC Circuit
We now show that oscillatory behavior in an electrical RLC circuit is also described by the damped harmonic oscillator model. Consider the series circuit in Fig. {ref}`fig:18.03` consisting of a resistor R, inductor L, and capacitor C.

Using Kirchhoff's voltage law around the closed loop, we write:
$$
V = L\dot{I} + RI + \frac{1}{C}\int_{0}^{t} I,dt'
$$

where $I$ is the current through the inductor. The first term accounts for the back electromotive force induced in the inductor according to Faraday's law. The second term represents resistive voltage drop from Ohm's law. The final term incorporates the voltage accumulated across the capacitor from charge integration.

Taking the time derivative and rearranging yields the governing differential equation:
$$
L\ddot{I}+R\dot{I}+\frac{1}{C}I=0
$$

Upon non-dimensionalizing time as $t\rightarrow t/\sqrt{LC}$ and defining the damping ratio $\zeta = R/\left(2\sqrt{L/C}\right)$, we obtain the normalized damped harmonic oscillator equation:
$$
\ddot{I} + 2\zeta I + I = 0.
$$

    

Thus, oscillations in the RLC circuit are mathematically equivalent to those in the spring-mass and pendulum systems near equilibrium. Despite physical differences, the key attribute shared is oscillatory dynamics governed by a second-order differential equation with damping. This establishes a fundamental systems-level correspondence that will prove insightful moving forward in analyzing oscillatory phenomena across diverse domains.

```{figure} Figures/fig-18.03.png
:name: fig:18.03

RLC series circuit.
```

## Steady State Analysis
We can gain further insights by recasting the damped harmonic oscillator equation as a system of first-order differential equations. Starting from the second-order form:
$$
\ddot{x} + 2\zeta \dot{x} + x = 0.
$$

Define a new variable $y=\dot{x}$ to represent velocity. This allows us to write the original equation as a coupled system:
$$
\dot{x}=y,
$$

$$
\dot{y}=-2\zeta y - x.
$$

In vector form:
$$
\dot{\vec{r}} = \mathbf{J}\vec{r},
$$

where $\vec{r}=(x,y)^T$ while the Jacobian matrix is:
$$
\mathbf{J}=
\left[
\begin{array}{rr}
0 & 1 \\
-1 & -2\zeta
\end{array}
\right]
$$

    
Due to the linearity of the system, it possesses a single fixed point given by the zero vector, $\vec{r}^* = (0,0)$. We can determine the general solution by exploiting the eigenstructure of the Jacobian matrix $\mathbf{J}$. Specifically, the eigenvalues $\lambda_{1,2}$ and corresponding eigenvectors $\vec{v}_{1,2}$ of $\mathbf{J}$ allow us to write the solution as:
$$
\vec{r}(t) = C_1 \vec{v}_1 e^{\lambda_1 t} + C_2 \vec{v}_2 e^{\lambda_2 t},
$$

with $C_1$ and $C_2$ arbitrary constants determined by the initial conditions. 

The eigenvalues of the Jacobian matrix at the origin are:
$$
\lambda_{1,2} = -z \pm \sqrt{\zeta^2-1}
$$

For a damping ratio of $\zeta=0$, the eigenvalues are purely imaginary, indicating that the fixed point is a center. When $0<\zeta<1$, the eigenvalues form a complex conjugate pair with negative real parts. Therefore, the fixed point is a stable spiral; perturbations will result in damped oscillations converging towards the steady state. This regime corresponds to underdamped oscillations. Finally, for $\zeta>1$, the eigenvalues are both real and negative. In this case, the fixed point is a stable node; perturbations decay monotonically without oscillation. The system is said to be in the overdamped regime.

In closing, we note that the only means of achieving truly undamped oscillations with $\zeta = 0$ would be in an idealized, isolated system without any dissipative effects. However, the second law of thermodynamics dictates that all real physical systems experience some form of damping or energy loss over time. The damping terms in our analysis have accounted for these non-conservative effects that cause oscillatory motions to gradually lose energy and amplitude. The type of decay---overdamped, critically damped, or underdamped oscillations---depends sensitively on the relative strength of damping represented by the dimensionless ratio $\zeta$.

## Application to Biological Systems
Many fundamental biological processes exhibit oscillatory dynamics that can be modeled as damped harmonic oscillators. Some key examples include:

1. Muscle contraction/relaxation: The cyclic interaction of actin and myosin filaments, driven by ATP hydrolysis, gives rise to damped oscillations. The viscoelastic properties of muscle fibers introduce damping.

2. Neural oscillations: Large populations of neurons can fluctuate collectively near a limit cycle regime. Damping regulates transitions between distinct firing states.

3. Cardiovascular system: Each heartbeat and respiratory cycle involves pressure and volume oscillations that are smoothed by viscous damping into pressure-volume loops.

4. Gene regulation: Negative feedback in transcription/translation causes gene expression levels to oscillate. Molecular noise and resource depletion attenuate the oscillations over time.

While real biological systems are high-dimensional and stochastic, damped oscillator theory provides qualitative insights into self-sustained rhythms, resonance effects, and characteristic relaxation timescales. For instance, analysis of damping ratios could inform drug delivery strategies that modulate the rate at which oscillations decay.

However, the damped harmonic oscillator has limitations in describing some biological oscillators. In particular, relaxation oscillators may better capture the repetitive behavior of autoregulated cells like cardiac pacemaker cells. Relaxation oscillators exhibit alternating periods of stasis and rapid switching between states, resembling a staircase waveform arising from thresholds in the system dynamics. In the next section, we analyze relaxation oscillators to understand the core properties underlying rhythmic behaviors in tissues such as the heart.

## Discussion
In this chapter, we explored the damped harmonic oscillator model; a fundamental oscillatory system found throughout physics and biology. We derived the canonical second-order differential equation that governs damped harmonic oscillations and analyzed its properties both analytically and qualitatively.

We also showed how real-world phenomena involving oscillatory motion in springs, pendulums, and electrical circuits can often be approximated as damped harmonic oscillators. This revealed the broad applicability and insights provided by studying these foundational systems.

However, damped harmonic oscillator have some limitations in capturing certain biological oscillators. In particular, relaxation oscillators may better describe the behavior of excitable cells like cardiac pacemaker cells that exhibit an alternating staircase-like waveform.

This sets the stage for the next chapter, where we will introduce and analyze relaxation oscillators. Characterizing these self-sustained oscillating systems will advance our quantitative and mechanistic understanding of rhythmic processes in living tissues and their relationship to cellular-level properties of excitability and threshold dynamics.

The overarching goal of examining damped and relaxation oscillators is to build dynamical system models that provide conceptual links between distinct realms which, at the component level, may seem very different but share underlying mathematical commonalities at a system-wide scale.

## Exercises
1. Numerically solve the differential equation 
    $$
    \ddot{x} + b \dot{x} + x = 0
    $$

    for various values of the parameter $b$, both above and below the critically damped regime ($b = 2$). Consider the initial conditions $x(0)=1$, $\dot{x}(0)=0$. Plot the solutions of $x$ versus $t$. Identify the value of $b$ that results in the fastest decay and explain the underlying reasons for this behavior.
  
2. Numerically solve the differential equation from the previous exercise with the initial condition $x(0) = 1$ and various values of $\dot{x}(0)$, both positive and negative. Plot the solutions of $x$ versus $t$. Next, repeat the exercise for increasing values of the parameter $b$. Discuss the behavior of the solutions in the regime where $b \gg 1$. Additionally, compare these results with the solutions of the differential equation 
    $$
    \dot{x} = -\frac{x}{b}
    $$

    with the initial condition $x(0) = 1$, which yields 
    $$
x(t) = \exp\left(-\frac{t}{b}\right).
$$

    Reflect on your observations.
  
  
  